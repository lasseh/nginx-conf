# Deny access to sensitive files and directories
# Prevent access to common sensitive files

# Deny access to hidden files and directories (except .well-known for ACME challenges)
location ~ /\\.(?!well-known) {
    deny all;
    access_log off;
    log_not_found off;
}

# Deny access to backup and temporary files
location ~ ~$ {
    deny all;
    access_log off;
    log_not_found off;
}

# Deny access to configuration files
location ~* \.(conf|config|sql|bak|backup|log)$ {
    deny all;
    access_log off;
    log_not_found off;
}

# Deny access to version control and sensitive directories
location ~ /\\.(git|svn|hg|bzr)|/(node_modules|vendor)/ {
    deny all;
    access_log off;
    log_not_found off;
}

# Deny access to common sensitive files
location ~* (readme|license|changelog|install|upgrade)\.txt$ {
    deny all;
    access_log off;
    log_not_found off;
}