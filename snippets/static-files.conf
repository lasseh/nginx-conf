# Static file serving optimization
# Efficient handling of static assets with proper caching
# NOTE: Each location block re-includes security-headers.conf because
# nginx discards ALL parent add_header directives when a location uses its own.

# Images
location ~* \.(jpg|jpeg|png|gif|ico|svg)$ {
    include snippets/security-headers.conf;
    expires 1y;
    add_header Cache-Control "public, immutable";
    access_log off;
}

# CSS and JavaScript
location ~* \.(css|js)$ {
    include snippets/security-headers.conf;
    expires 1y;
    add_header Cache-Control "public, immutable";
    access_log off;
}

# Web fonts
location ~* \.(woff|woff2|ttf|eot)$ {
    include snippets/security-headers.conf;
    expires 1y;
    add_header Cache-Control "public, immutable";
    access_log off;

    # CORS for web fonts
    add_header Access-Control-Allow-Origin *;
}

# Documents
location ~* \.(pdf|doc|docx|xls|xlsx|ppt|pptx)$ {
    include snippets/security-headers.conf;
    expires 1d;
    add_header Cache-Control "public, no-transform";
}

# Media files
location ~* \.(mp4|mp3|webm|ogg|wav|flac)$ {
    include snippets/security-headers.conf;
    expires 1M;
    add_header Cache-Control "public, immutable";
    access_log off;
}