# =============================================================================
# HTTP/3 (QUIC) HEADERS AND SETTINGS
# =============================================================================
# Include this snippet in HTTPS server blocks after adding QUIC listeners
#
# IMPORTANT: You must also add QUIC listeners to your server block:
#   listen 443 quic;
#   listen [::]:443 quic;
#   http3 on;
#
# NOTE: Only ONE server block should have 'reuseport' (typically defaults-443.conf)
#       All other server blocks should use 'listen 443 quic;' WITHOUT reuseport
#
# Firewall: Ensure UDP port 443 is open:
#   ufw allow 443/udp
#   # or: iptables -A INPUT -p udp --dport 443 -j ACCEPT

# Advertise HTTP/3 availability via Alt-Svc header
# ma=86400 means browsers remember HTTP/3 support for 24 hours
add_header Alt-Svc 'h3=":443"; ma=86400' always;

# QUIC transport settings
quic_retry on;       # Validate client addresses (DDoS protection)
quic_gso on;         # Generic Segmentation Offload (better performance)

# 0-RTT early data for faster reconnections
# WARNING: Vulnerable to replay attacks for POST/PUT/DELETE requests
# Only enable explicitly on sites that understand the risk
# ssl_early_data on;
